<script type="text/javascript">
// Bind events and callbacks
$(document).ready(function(){

  // Initial setup of autocomplete
  var users = new Bloodhound({
    datumTokenizer: Bloodhound.tokenizers.whitespace,
    queryTokenizer: Bloodhound.tokenizers.whitespace,
    // url points to a json web service that contains an array of users
    remote: {
      url: 'webservice/users?action=return&text=%QUERYSTRING',
      wildcard: '%QUERYSTRING'
    }
  });

  var items = new Bloodhound({
    datumTokenizer: Bloodhound.tokenizers.whitespace,
    queryTokenizer: Bloodhound.tokenizers.whitespace,
    // url points to a json web service that contains an array of users
    remote: {
      url: 'webservice/items?action=return&text=%QUERYSTRING',
      wildcard: '%QUERYSTRING'
    }
  });

  // Enable auto-complete feature (typeahead) for fields "item" and "user"
  $('#user_search').typeahead({
    hint: true,
    highlight: true,
    minLength: 3
  },
  {
    name: 'users',
    source: users,
    display: function (suggestion) {
      return(suggestion.text);
    }
  });
  $('#item_search').typeahead({
    hint: true,
    highlight: true,
    minLength: 3
  },
  {
    name: 'items',
    source: items,
    display: function (suggestion) {
      return(suggestion.text);
    }
  });

  // Callbacks for auto-completion
  $('#item_search').bind('typeahead:select', function(event, suggestion) {
    console.log('Selection: ',suggestion);
    $("#item_id").val(suggestion.id);
    $(event.target).closest(".form-group").removeClass("has-error has-warning").addClass("has-success");
  });
  $('#user_search').bind('typeahead:select', function(event, suggestion) {
    console.log('Selection: ',suggestion);
    $("#user_id").val(suggestion.id);
    $(event.target).closest(".form-group").removeClass("has-error has-warning").addClass("has-success");
  });

});
</script>
